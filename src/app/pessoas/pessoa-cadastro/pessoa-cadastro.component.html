<div class="container">
  <form #form="ngForm"
        (ngSubmit)="salvar(form)">
    <div class="ui-g">
      <div class="ui-g-12">
        <h1> {{editado ? 'Edição de ': 'Nova'}} Pessoa</h1>
      </div>
      <div class="ui-g-12 ui-fluid">
        <label>Nome</label>
        <input pInputText
               type="text"
               required
               minlength="5"
               name="nome"
               #nome="ngModel"
               [(ngModel)]="pessoa.nome">
        <app-message [control]="nome"
                     error="required"
                     text="Informe o nome">
        </app-message>
        <app-message [control]="nome"
                     error="minlength"
                     text="Mínimo de {{ nome.errors?.minlength?.requiredLength }} caracteres">
        </app-message>
      </div>

      <div class="ui-g-8 ui-fluid">
        <label>Logradouro</label>
        <input pInputText
               type="text"
               required
               name="logradouro"
               #logradouro="ngModel"
               [(ngModel)]="pessoa.endereco.logradouro">
        <app-message [control]="logradouro"
                     error="required"
                     text="Informe o logradouro">
        </app-message>
      </div>
      <div class="ui-g-4 ui-fluid">
        <label>Número</label>
        <input pInputText
               type="text"
               required
               name="numero"
               #numero="ngModel"
               [(ngModel)]="pessoa.endereco.numero">
        <app-message [control]="numero"
                     error="required"
                     text="Informe o numero">
        </app-message>
      </div>
      <div class="ui-g-12 ui-md-4 ui-fluid">
        <label>Complemento</label>
        <input pInputText
               type="text"
               name="complemento"
               [(ngModel)]="pessoa.endereco.complemento">
      </div>

      <div class="ui-g-12 ui-md-4 ui-fluid ">
        <label>Bairro</label>
        <input pInputText
               type="text"
               required
               name="bairro"
               #bairro="ngModel"
               [(ngModel)]="pessoa.endereco.bairro">
        <app-message [control]="bairro"
                     error="required"
                     text="Informe o bairro">
        </app-message>
      </div>
      <div class="ui-g-12 ui-md-4 ui-fluid">
        <label>CEP </label>
        <p-inputMask name="cep"
                     mask="99.999-999"
                     #cep="ngModel"
                     [(ngModel)]="pessoa.endereco.cep"
                     required></p-inputMask>
        <app-message [control]="cep"
                     error="required"
                     text="Informe o CEP"></app-message>
      </div>
      <div class="ui-g-12 ui-md-6 ui-fluid">
        <label>Cidade</label>
        <input pInputText
               type="text"
               required
               name="cidade"
               #cidade="ngModel"
               [(ngModel)]="pessoa.endereco.cidade">
        <app-message [control]="cidade"
                     error="required"
                     text="Informe a cidade">
        </app-message>
      </div>
      <div class="ui-g-12 ui-md-6 ui-fluid">
        <label>Estado</label>
        <input pInputText
               type="text"
               required
               name="estado"
               #estado="ngModel"
               [(ngModel)]="pessoa.endereco.estado">
        <app-message [control]="estado"
                     error="required"
                     text="Informe o estado">
        </app-message>
      </div>

      <div class="ui-g-12">
        <p-panel header="Contatos">
          <div class="ui-g">
            <div class="ui-g-12">
              <button pButton
                      icon="pi pi-plus"
                      label="Novo"
                      type="button"
                      class="ui-button-secondary"
                      (click)="prepararNovoContato()">

              </button>
            </div>
            <div class="ui-g-12">
              <p-table [value]="pessoa.contatos"
                       [responsive]="true">

                <ng-template pTemplate="header">
                  <tr>
                    <th>Nome</th>
                    <th>E-mail</th>
                    <th>Telefone</th>
                    <th class="col-acoes-header"></th>
                  </tr>

                </ng-template>
                <ng-template pTemplate="body"
                             let-contato>
                  <tr>
                    <td>{{contato.nome}}</td>
                    <td>{{contato.email}}</td>
                    <td>{{contato.telefone}}</td>
                    <td class="col-acoes">
                      <p-button type="button"
                                style="margin-right: 4px;"
                                icon="pi pi-pencil"
                                pTooltip="Editar"
                                [routerLink]="['/pessoas', pessoa.id]"
                                tooltipPosition="top"></p-button>
                      <p-button type="button"
                                icon="pi pi-trash"
                                pTooltip="Excluir"
                                tooltipPosition="top"></p-button>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr>
                    <td colspan="4">
                      Nenhum contando cadastrado.
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </p-panel>
      </div>

      <div class="ui-g-12">
        <p-button type="submit"
                  label="Salvar"
                  [disabled]="!form.valid"></p-button>
        <p-button type="button"
                  label="Nova"
                  (click)="novo(form)"
                  styleClass="ui-button-info"></p-button>
        <a routerLink="/pessoas">Voltar para Pesquisa </a>
      </div>
    </div>
  </form>
</div>
<p-dialog header="Novo Contato"
          [(visible)]="exbindoFormularioContato"
          modal="true"
          *ngIf="contato"
          >
  <form #fContado="ngForm" (ngSubmit)="confirmarContato(fContado)">
    <div class="ui-g-12 ui-fluid">
      <label>Nome</label>
      <input pInputText
             type="text"
             name="nome"
             required
             [(ngModel)]="contato.nome"
             #contatoNome="ngModel" />
      <app-message [control]="contatoNome"
                   erro="required"
                   text="Informe o nome">
      </app-message>
    </div>

    <div class="ui-g-12 ui-fluid">
      <label>Email</label>
      <input pInputText
             type="email"
             name="email"
             required
             email
             [(ngModel)]="contato.email"
             #contatoEmail="ngModel" />
      <app-message [control]="contatoEmail"
                   erro="required"
                   text="Informe o e-mail">

      </app-message>
      <app-message [control]="contatoEmail"
                   erro="email"
                   text="Informe o e-mail válido">
      </app-message>

    </div>
    <div class="ui-g-12 ui-fluid">
      <label>Telefone</label>
      <p-inputMask type="text"
                   name="telefone"
                   [(ngModel)]="contato.telefone"
                   mask="(99) 9999-9999?9">

      </p-inputMask>
    </div>
    <div clas="ui-g-12">
      <p-button type="submit"
                label="Confirmar"
                [disabled]="fContado.invalid">

      </p-button>
    </div>
  </form>
</p-dialog>